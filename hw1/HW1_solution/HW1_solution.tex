\documentclass[11pt]{article}

% Load packages
\usepackage{minted}
\usepackage{amsmath, amsfonts, mathtools} % for math
\usepackage{graphicx, float} % for figures
\usepackage[margin=1in]{geometry} % to set margins
\usepackage{tcolorbox} % to create nice boxes
\tcbuselibrary{skins,breakable} % extra libraries for the nice boxes
\allowdisplaybreaks % allow aligned equations to display across pages

% Sets the default font to sans serif
% \renewcommand\familydefault{\sfdefault}

% Define a custom box for the solutions. Don't change this!
\newtcolorbox[]{solution}
    {colframe=red!20, 
        colback=white, 
        sharp corners,
        title=Solution,
        enhanced,
        breakable,
        coltitle=black,
        fonttitle=\bfseries,
        attach boxed title to top left={yshift*=-\tcboxedtitleheight/2, xshift=3mm},
        boxed title style={sharp corners, colback=red!20}
        }

\usepackage{boondox-calo}
\newcommand{\lr}[1]{\left(#1\right)}

\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan
}



% Write the document
\begin{document}
    \title{Extreme Computing: Homework 1}
    \author{Michael S. Emanuel, Jonathan Guillotte-Blouin, Erick Ruiz, Yue Sun}
    \date{February 25, 2019}
    \maketitle
    
  \section{Problem 1:  Couette Flow}
    % Problem statement
    Couette flow is a classic, basic flow pattern in which a fluid is confined between two, smooth parallel plates. The bottom plate (at $y=-h$) is stationary, while the top plate (at $y=h$) is moving with a constant velocity $U$. It is assumed that the flow is steady, fully developed, two-dimensional (i.e. independent of $z$), and there is a zero pressure gradient. Figure~\ref{fig:couette} shows a diagram of the flow configuration.
    \begin{figure}[H]
    	\centering
    	\begin{tikzpicture}[scale=1.5]
    		% fluid
    		\path[fill=blue!15!] (0,0) rectangle (4,2);
    		
    		% plates
    		\draw[fill=gray] (0,0) rectangle (4,-0.1);
    		\draw[fill=gray] (0,2) rectangle (4,2.1);
    		
    		% plate heights
    		\node at (-1,0) {$y=-h$};
    		\node at (-1,2) {$y=h$};
    		
    		% top plate velocity
    		\draw[->, >=stealth] (4.25,2.05) -- (5.25,2.05);
    		\node at (5.75,2.05) {$U$};
    		
    		% reference frame
    		\draw[<->, >=stealth] (-3,2) -- (-3,1) -- (-2,1);
    		\node at (-3,2.25) {$y$};
    		\node at (-1.75,1) {$x$};
    		
    		% velocity field
    		\node at (2,1) {$\vec{u} = $?};
    	\end{tikzpicture}
    	\caption{A schematic of the Couette flow configuration, with the velocity profile included.}
    	\label{fig:couette}
    \end{figure}
    Use no-slip boundary conditions to calculate the velocity and vorticity fields, the components of the shear stress tensor, the volume flow rate, and the average and maximum velocities in the channel. Also, make a plot of the velocity profile at a few different values of $U$. Be sure to put $y$ on the $y$-axis and $u(y)$ on the $x$-axis of your plot.

    % Solution    
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p1.tex}
    \end{solution}
    \pagebreak

    \section{Problem 2:  Rectangular Duct Flow}
    Consider the case where we have flow through a rectangular cross section as shown in the Figure (\ref{fig:rect_duct}). Assuming that the flow is steady, fully developed in $x$, and has only one component (i.e. $v = w = 0$), find the velocity field by simplifying the Navier-Stokes momentum equation and solving it using no-slip boundary conditions on all surfaces. Also, note that the flow is driven by a prescribed (known) pressure gradient in the $x$-direction.

    \begin{figure}[H]
		\centering
		\begin{tikzpicture}
			% y-z plane
			\draw[<->, >=stealth] (-0.5,1) -- (-0.5,0) --(0.5,0);
			\node at (-0.5,1.25) {$y$};
			\node at (0.75,0) {$z$};
			
			% cross-section
			\draw[fill=gray] (2,0) rectangle (5,2);
			\draw[fill=blue!15!] (2.1,0.1) rectangle (4.9,1.9);
			
			% x-y plane
			\draw[<->, >=stealth] (6,1) -- (6,0) -- (7,0);
			\node at (6,1.25) {$y$};
			\node at (7.25,0) {$x$};
			
			% profile
			\path[fill=blue!15!] (8.1,0) rectangle (11.9,2);
			\draw[fill=gray] (8,0) rectangle (12,0.1);
			\draw[fill=gray] (8,2) rectangle (12,1.9);
			
			% velocity field
			\node at (10,1) {$\vec{u} =$ ?};
			
			% duct height
			\draw[|<->|, >=stealth] (1.5,0) -- (1.5,2);
			\node[circle, fill=white] at (1.5,1) {$a$};
			
			% duct width
			\draw[|<->|, >=stealth] (2,2.5) -- (5,2.5);
			\node[circle, fill=white] at (3.5,2.5) {$b$};
			
			% pressure
			\node at (7.5,1) {$p_1$};
			\node at (13,1) {$p_2 < p_1$};
		\end{tikzpicture}
		\caption{A schematic of the flow geometry}
		\label{fig:rect_duct}
	\end{figure}

    \subsection{Governing Equations}
    Using the provided assumptions, show that the Navier-Stokes equations reduce to
    \begin{align}
      \left(\frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}\right) u(y,z) = \frac{1}{\mu}\frac{\partial p}{\partial x}.
    \end{align}
    \textbf{What are the boundary conditions?}
    
    % 2.1 Solution
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p2-1.tex}
    \end{solution}

    \subsection{Solving for $u$: Part 1}
    We have an inhomogenous, linear PDE on our hands.  Let's solve this using the method of eigenfunction expansions.  We know that with the current boundary conditions, the homogenous solution to our equation has eigenfunctions that are sines. Hence, let's assume a solution of the form
    \begin{align}
      u\left(y, z\right) = \sum_{n=1}^{\infty}{\beta_{n}\left(z\right)\sin\left(\frac{n\pi}{a}y\right)}.
    \end{align}
    Substitute this ansatz into the governing PDE and show that the unknown coefficients, $\beta_{n}\left(z\right)$, are governed by the following inhomogenous ODE.
    \begin{align}
        \beta_{n}^{\prime\prime} - \gamma_{n}^{2}\beta_{n} = q_{n}
        \label{eq:betan}
    \end{align}
    Here, $\left(\cdot\right)^{\prime}$ denotes $d/dz$, $\gamma_n$ is the eigenvalue, and $q_n$ and $Q$ are defined as follows.
    \begin{align}
        \gamma_n &= \frac{n \pi}{a}\\
        q_{n} &= \dfrac{2}{a}\int_{0}^{a}{Q\sin\left(\gamma_{n}y\right)\ \mathrm{d}y}\\
        Q &= \frac{1}{\mu}\frac{\partial p}{\partial x}
    \end{align}

    \subsubsection{Some Specific Details}
    Here is a breakdown of the required steps.
    \begin{enumerate}
      \item First show that after plugging the assumed form into the governing PDE the resulting expression is 
      \begin{align}
        \sum_{n=1}^{\infty}{\beta_{n}^{\prime\prime}\sin\left(\dfrac{n\pi}{a}y\right)} -
\sum_{n=1}^{\infty}{\beta_{n}\left(\dfrac{n\pi}{a}\right)^{2}\sin\left(\dfrac{n\pi}{a}y\right)} = Q.
      \end{align}
      \item Next, multiply by $\sin\left(\dfrac{m\pi}{a}y\right)$ and integrate over $y$.
      \begin{align}
        &\int_{0}^{a}{\sum_{n=1}^{\infty}{\beta_{n}^{\prime\prime}\sin\left(\dfrac{n\pi}{a}y\right)\sin\left(\dfrac{m\pi}{a}y\right)}
\ \mathrm{d}y} -
\int_{0}^{a}{\sum_{n=1}^{\infty}{\beta_{n}\left(\dfrac{n\pi}{a}\right)^{2}\sin\left(\dfrac{n\pi}{a}y\right)\sin\left(\dfrac{m\pi}{a}y\right)}
\ \mathrm{d}y} = \nonumber \\
        &\hspace{2.0em}\int_{0}^{a}{Q\sin\left(\dfrac{m\pi}{a}y\right) \ \mathrm{d}y}.
      \end{align}
      \item That's a pretty big mess.  Now, we use a beautiful result:  the orthogonality of sines:
        \begin{align}
          \int_{0}^{a}{\sin\left(\dfrac{n\pi}{a}y\right)\sin\left(\dfrac{m\pi}{a}y\right) \ \mathrm{d}y} = 
          \left\{
            \begin{array}{ll}
              0            \qquad n \neq m \\
              \dfrac{a}{2} \qquad n = m
            \end{array}
          \right.
        \end{align}
        The main point here is that every single term in the infinite sum is zero \textit{except} for the term where $n=m$.
      \item The final result is 
        \begin{align}
          \beta_{n}^{\prime\prime} - \gamma_{n}^{2}\beta_{n} = \dfrac{2}{a}\int_{0}^{a}{Q\sin\left(\gamma_{n}y\right) \ \mathrm{d}y}
        \end{align}
    \end{enumerate}

    \textbf{What are the boundary conditions on $\beta_{n}$}?
    
    % 2.2 Solution
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p2-2.tex}
    \end{solution}

    \subsection{Solving for $\beta_{n}$: The Homogeneous Part}
    To solve for $\beta_{n}$, we first need to solve the homogeneous equation,
    \begin{align}
      \beta_{n}^{\prime\prime} - \gamma_{n}^{2}\beta_{n} = 0.
    \end{align}
    Show that the homogeneous solution is 
    \begin{align}
      \beta_{n}^{H} = c_{1}w_{1} + c_{2}w_{2}
    \end{align}
    where $w_{1} = \sinh\left(\gamma_{n}z\right)$ and $w_{2} = \cosh\left(\gamma_{n}z\right)$ are the two linearly independent solutions.
    
    % 2.3 Solution
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p2-3.tex}
    \end{solution}

    \subsection{Solving the Inhomogeneous Part}
    You can use the method of variation of parameters to solve the inhomogeneous equation.  Let 
    \begin{align}
        \beta_{n}\left(z\right) = v_{1}\left(z\right)w_{1}\left(z\right) + v_{2}\left(z\right)w_{2}\left(z\right),
        \label{eq:var_param}
    \end{align}
    where $v_{1}\left(z\right)$ and $v_{2}\left(z\right)$ are the coefficients (parameters) to be varied.  Now, \emph{assume} that 
    \begin{align}
        w_{1}v_{1}^{\prime} + w_{2}v_{2}^{\prime} = 0.
        \label{eq:var_const}
    \end{align}
    Substituting \eqref{eq:var_param} into~\eqref{eq:betan} and using~\eqref{eq:var_const} yields two equations for
$v_{1}^{\prime}$ and $v_{2}^{\prime}$.
    \begin{align}
      w_{1}v_{1}^{\prime} + w_{2}v_{2}^{\prime} &= 0 \\
      w_{1}^{\prime}v_{1}^{\prime} + w_{2}^{\prime}v_{2}^{\prime} &= q_{n}
    \end{align}
    Show that 
    \begin{align}
      v_{1} &= \frac{q_{n}}{\gamma_{n}^{2}}\sinh\left(\gamma_{n}z\right) + \alpha_{1} \\
      v_{2} &= -\frac{q_{n}}{\gamma_{n}^{2}}\cosh\left(\gamma_{n}z\right) + \alpha_{2} 
    \end{align}
    where $\alpha_{1}$ and $\alpha_{2}$ are constants of integration.

    Finally, show that 
    \begin{align}
      \beta_{n}\left(z\right) &= C_{n} 
        \left[-\sinh\left(\gamma_{n}b\right) + \sinh\left(\gamma_{n}z\right) - 
          \left(\sinh\left(\gamma_{n}z\right)\cosh\left(\gamma_{n}b\right) - 
            \cosh\left(\gamma_{n}z\right)\sinh\left(\gamma_{n}b\right)\right)\right] \\
      &=  C_{n}
           \left[\sinh\left(\gamma_{n}z\right) - \sinh\left(\gamma_{n}b\right) - 
            \sinh\left(\gamma_{n}\left(z-b\right)\right)\right] \label{eq:beta-cn}\\
      &= 2C_{n}\sinh\left(\dfrac{\gamma_{n}}{2}\left(z-b\right)\right) 
           \left[\cosh\left(\dfrac{\gamma_{n}}{2}\left(z+b\right)\right) - 
             \cosh\left(\dfrac{\gamma_{n}}{2}\left(z-b\right)\right)\right].
    \end{align}
    where 
    \begin{align}
      C_{n} = \frac{q_{n}}{\gamma_{n}^{2}\sinh\left(\gamma_{n}b\right)}. 
    \end{align}
    
    % 2.4 Solution
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p2-4.tex}
    \end{solution}

    \subsection{The Velocity Field}
    Put everything together to show that the velocity profile can be written as follows.
    \begin{align}
      u\left(y,z\right) = \sum_{n=1}^{\infty}{2C_{n} 
        \sinh\left(\dfrac{\gamma_{n}}{2}\left(z-b\right)\right)\left[\cosh\left(\dfrac{\gamma_{n}}{2}\left(z+b\right)\right) - 
          \cosh\left(\dfrac{\gamma_{n}}{2}\left(z-b\right)\right)\right]\sin\left(\gamma_{n}y\right)}
    \end{align}
    A good sanity check is to make sure the boundary conditions are satisfied by this solution.

    \subsubsection{Other Thoughts}
    There are a variety of things that can be computed and inspected from here.  For example:
    \begin{itemize}
      \item Calculate the vorticity and streamlines.  Any surprises here?
      \item How does the solution change if you have different boundary conditions?
        \begin{itemize}
          \item Neumann boundary conditions on each surface 
          \item Dirichlet boundary conditions on all surfaces \emph{except} at $y=a$ for which we have a Neumann condition. (This would be like fluid flowing through an open channel.)
        \end{itemize}
    \end{itemize}
    \textbf{Note:}  You are not required to compute any of these for this assignment!
    
    % 2.5 Solution
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p2-5.tex}
    \end{solution}

  \subsection{Visualization}
  Now that we have an explicit formula for the velocity field, we can visualize it.  Try to make the following plots:
  \begin{itemize}
    \item Plot $u\left(y,z=z^{*}\right)$ at a few values of $z^{*}$ (perhaps near the boundary, $1/4$ of the channel width, and
at half the channel width).
    \item Plot $u\left(y=y^{*},z\right)$ at a few values of $y^{*}$ (perhaps near the boundary, $1/4$ of the channel height, and
at half the channel height).
    \item Make a surface plot of $u\left(y,z\right)$.
  \end{itemize}
  
    % 2.6 Solution
    \begin{solution}
        \input{hw01_eruiz/ac290r_hw01_p2-6.tex}
    \end{solution}
    \pagebreak

  \section{Problem 3: The Finite Element Method}

  Consider the steady one-dimensional advection-diffusion-reaction equation,
  \begin{align}
    a\partial_{x}u -\lambda u - k\partial_{x}^{2}u = f, \qquad x\in\left(0, 1\right)
    \label{eq:adv-diff-rxn}
  \end{align}
  with boundary conditions 
  \begin{align}
    u\left(0\right) = u_{0}, \quad -k\partial_{x}u\left(1\right) = b_{1}.
    \label{eq:adr_bcs}
  \end{align}
  In~\eqref{eq:adv-diff-rxn}, $a$ is the constant advection speed, $\lambda > 0$ is the constant reaction coefficient, and $k>0$ 
  is the constant diffusion coefficient.  

  \subsection{Weak Form}
  Write the weak form corresponding to the strong form~\eqref{eq:adv-diff-rxn}.  Be sure to specify all function spaces. Don't forget to include any boundary terms.

  \input{HW1_P3_Yue/HW1_P3a_Yue.tex}

  \subsection{Galerkin Statement}
  From the weak form, write the Galerkin statement.  Again, specify all function spaces.
  
  \input{HW1_P3_Yue/HW1_P3b_Yue.tex}

  \subsection{Finite Element Discretization}
  Introduce the finite element basis and arrive at a linear algebra problem.  Clearly define the form of all resulting matrices.  You may write everything in terms of the basis functions (i.e. there is no need to directly compute the entries of the matrices).

  \input{HW1_P3_Yue/HW1_P3c_Yue.tex}
  \pagebreak
  
  \section{Problem 4: Implementation}
  We wish to use the finite element method to solve 
  \begin{align}
    - \partial_{x}^{2} u = f\lr{x}, \qquad x \in \lr{0, 1} \\
    -\partial_{x}u\lr{0} = \mathcal{h}, \quad u\lr{1} = \mathcal{g}
  \end{align}
  for $u\lr{x}$ where $f\lr{x}$ is a known forcing function and $\mathcal{g}$ and $\mathcal{h}$ are constant boundary data.

  Write a one-dimensional finite element code that uses piecewise linear finite elements to solve for $u\lr{x}$.  The
following specifications are required:
  \begin{itemize}
    \item The code should work for any constant $\mathcal{g}$ and $\mathcal{h}$ as well as arbitrary $f\lr{x}$.  These will be inputs to the
code.
    \item Other inputs should include the domain size.  You have some flexibility on how to do this.  For example, you may
pass in a fully-formed mesh if you wish.  Alternatively, you can require the user to specify the number of elements from
which your code can compute the uniform mesh size.
      \begin{itemize}
        \item \textbf{Note:} You may assume a uniform mesh.
      \end{itemize}
    \item The code \textbf{must} use the local point of view.  That is, loop over individual elements and perform the finite
element assembly operation to form the global stiffness matrix and force vector.
    \item Use Gaussian quadrature to perform the integrals.  Although not strictly necessary here, it will give you some
intuition for how things are actually done.
    \item You may use an external library to solve the resulting linear system.
    \item Use must use a compiled language such as \texttt{C}, \texttt{C++}, or (modern) Fortran.
    \item Try to submit your job on Odyssey!
  \end{itemize}

  Some other things you may want to consider are the following:
  \begin{itemize}
    \item Start simple.  A natural progression may be the following:
      \begin{itemize}
        \item Select $f = 0$, $g = 0$ and $h = 1$ to begin.  The exact solution will be $u = 1 - x$.
        \item Then make $g = 1$, $h = 1$, $f = 0$.  The exact solution will be $u = 2 - x$.
        \item Finally, try $g = 1$, $h = 1$, and $f = 1$.  The exact solution will be $u = 2 - x + \dfrac{1}{2}\lr{1 -
x^{2}}$.
        \item At this point, you will have some confidence in your code.  This is called code verification.  You can try more
complicated $f\lr{x}$ if you'd like to.
      \end{itemize}
    \item Organize your code into separate files.  Use a \texttt{Makefile} to do the linking.
      \begin{itemize}
        \item You may want to have files for the following:
          \begin{itemize}
            \item Quadrature routines 
            \item Stiffness matrix routines 
            \item Right-hand-size (RHS) routines
          \end{itemize}
        \item Feel free to consider other code designs.
      \end{itemize}
  \end{itemize}
  
    % Problem 4 Solution
    \begin{solution}
        \input{HW1_P4_Jonathan/HW1_P4.tex}
    \end{solution}
  
\end{document}
